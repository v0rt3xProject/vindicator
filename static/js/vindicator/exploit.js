function getUpdates() {
    send({
        view: "exploit",
        action: "list"
    })
}

function setUpdates(data) {
    if (data.view == "exploit") {
        if (data.type == "list") {
            for (var i = 0; i < data.exploits.length; i++) {
                var exploit = data.exploits[i];
                var exploit_id = exploit.agentId + "_" + exploit.name;
                if (!$("tr#" + exploit_id).length) {
                    var exploit_row = $("<tr></tr>").attr("id", exploit_id);

                    exploit_row.append($("<td></td>").text(exploit.agentId));
                    exploit_row.append($("<td></td>").text(exploit.name));
                    exploit_row.append($("<td></td>").text(exploit.command));
                    exploit_row.append($("<td></td>").attr("id", "activity" + exploit_id).text(exploit.lastActivity));

                    $("#exploit_list").append(exploit_row);
                } else {
                    $("td#activity_" + exploit_id).text(exploit.lastActivity);
                }
            }
        }
    }
}