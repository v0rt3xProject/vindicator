function getUpdates() {
    send({
        view: "exploit",
        action: "list"
    })
}

function setUpdates(data) {
    if (data.view == "exploit") {
        if (data.type == "list") {
            for (var i = 0; i < data.exploits.length; i++) {
                var exploit = data.exploits[i];
                if (!$("tr#" + exploit.id).length) {
                    var exploit_row = $("<tr></tr>").attr("id", exploit.id);

                    exploit_row.append($("<td></td>").text(exploit.id));
                    exploit_row.append($("<td></td>").text(exploit.agentId));
                    exploit_row.append($("<td></td>").text(exploit.name));
                    exploit_row.append($("<td></td>").text(exploit.command));
                    exploit_row.append($("<td></td>").attr("id", "activity" + exploit.id).text(exploit.lastActivity));
                    exploit_row.append($("<td></td>").append(
                        $("<button></button>")
                            .attr('type', 'button')
                            .attr('class', 'btn btn-danger btn-sm')
                            .click(function () {
                                deleteExploit(exploit.id);
                            })
                            .text("Delete")
                    ));

                    $("#exploit_list").append(exploit_row);
                } else {
                    $("td#activity_" + exploit.id).text(exploit.lastActivity);
                }
            }
        } else if (data.type == "delete") {
            if (data.success) {
                $("tr#" + data.target).remove();
            }
        }
    }
}

function deleteExploit(exploitId) {
    send({
        action: 'delete',
        view: 'exploit',
        target: exploitId
    });
}